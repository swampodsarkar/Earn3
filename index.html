<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GE Coin Mining</title>
    <!-- Use Tailwind CSS via npm (production recommended) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid white;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .mining-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .status-badge {
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 9999px;
        }
        .status-pending {
            background-color: #fef3c7;
            color: #d97706;
        }
        .status-approved {
            background-color: #d1fae5;
            color: #059669;
        }
        .status-rejected {
            background-color: #fee2e2;
            color: #dc2626;
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            background-color: #e2e8f0;
        }
        .mining-avatar {
            width: 200px;
            height: 200px;
            font-size: 80px;
            margin: 0 auto;
            background-color: #c7d2fe;
            color: #4f46e5;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <!-- Navigation Bar -->
    <nav class="gradient-bg text-white shadow-lg" id="mainNav">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fas fa-coins text-yellow-300 text-2xl"></i>
                <span class="font-bold text-xl">GE Coin Mining</span>
            </div>
            <div class="hidden md:flex space-x-6" id="navLinks">
                <a href="#home" class="hover:text-yellow-300 transition"><i class="fas fa-home mr-1"></i> Home</a>
                <a href="#features" class="hover:text-yellow-300 transition"><i class="fas fa-star mr-1"></i> Features</a>
                <a href="#how-it-works" class="hover:text-yellow-300 transition"><i class="fas fa-question-circle mr-1"></i> How It Works</a>
            </div>
            <div class="flex space-x-4" id="authButtons">
                <button onclick="showAuthModal('login')" class="bg-white hover:bg-gray-100 text-blue-600 px-4 py-2 rounded-lg font-bold transition-all">
                    <i class="fas fa-sign-in-alt mr-2"></i> Login
                </button>
                <button onclick="showAuthModal('signup')" class="bg-yellow-400 hover:bg-yellow-500 text-gray-800 px-4 py-2 rounded-lg font-bold transition-all">
                    <i class="fas fa-user-plus mr-2"></i> Sign Up
                </button>
            </div>
        </div>
    </nav>

    <!-- Maintenance Banner -->
    <div id="maintenanceBanner" class="bg-red-600 text-white text-center py-2 hidden">
        <i class="fas fa-exclamation-triangle mr-2"></i>
        <span>This site is currently under maintenance. Please check back later.</span>
    </div>

    <!-- Main Content - Home Page -->
    <div id="homeContent">
        <!-- Hero Section -->
        <section id="home" class="mb-16">
            <div class="container mx-auto px-4 py-8">
                <div class="flex flex-col md:flex-row items-center">
                    <div class="md:w-1/2 mb-10 md:mb-0">
                        <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-6">Start Mining GE Coins Today</h1>
                        <p class="text-xl text-gray-600 mb-8">Earn cryptocurrency effortlessly with our easy-to-use mining platform. No technical knowledge required!</p>
                        <div class="flex space-x-4">
                            <button onclick="showAuthModal('signup')" class="gradient-bg hover:opacity-90 text-white px-8 py-4 rounded-lg font-bold text-lg transition-all">
                                <i class="fas fa-user-plus mr-2"></i> Get Started
                            </button>
                            <button onclick="document.getElementById('how-it-works').scrollIntoView({behavior: 'smooth'})" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-8 py-4 rounded-lg font-bold text-lg transition-all">
                                <i class="fas fa-play-circle mr-2"></i> How It Works
                            </button>
                        </div>
                    </div>
                    <div class="md:w-1/2 flex justify-center">
                        <div class="mining-avatar">
                            <i class="fas fa-digging"></i>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section id="features" class="mb-16">
            <div class="container mx-auto px-4">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold text-gray-800 mb-4">Why Choose GE Coin Mining?</h2>
                    <p class="text-xl text-gray-600 max-w-3xl mx-auto">Our platform offers the easiest way to earn cryptocurrency with minimal effort</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="bg-white rounded-xl shadow-md p-8 text-center">
                        <div class="text-blue-500 mb-6">
                            <i class="fas fa-bolt text-5xl"></i>
                        </div>
                        <h3 class="font-bold text-xl mb-4">Fast & Easy</h3>
                        <p class="text-gray-600">Start mining with just one click. No complex setup required.</p>
                    </div>
                    <div class="bg-white rounded-xl shadow-md p-8 text-center">
                        <div class="text-green-500 mb-6">
                            <i class="fas fa-users text-5xl"></i>
                        </div>
                        <h3 class="font-bold text-xl mb-4">Referral Program</h3>
                        <p class="text-gray-600">Earn 10% of your referrals' mining rewards. Invite friends and earn more!</p>
                    </div>
                    <div class="bg-white rounded-xl shadow-md p-8 text-center">
                        <div class="text-purple-500 mb-6">
                            <i class="fas fa-hand-holding-usd text-5xl"></i>
                        </div>
                        <h3 class="font-bold text-xl mb-4">Instant Withdrawals</h3>
                        <p class="text-gray-600">Withdraw your earnings easily. Minimum withdrawal only $5.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- How It Works Section -->
        <section id="how-it-works" class="mb-16">
            <div class="container mx-auto px-4">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold text-gray-800 mb-4">How It Works</h2>
                    <p class="text-xl text-gray-600 max-w-3xl mx-auto">Start earning in just 3 simple steps</p>
                </div>
                
                <div class="bg-white rounded-xl shadow-md p-8">
                    <div class="flex flex-col md:flex-row mb-8">
                        <div class="md:w-1/3 mb-6 md:mb-0 flex items-start">
                            <div class="bg-blue-100 text-blue-600 font-bold rounded-full w-12 h-12 flex items-center justify-center mr-4 text-xl">1</div>
                            <div>
                                <h3 class="font-bold text-xl mb-2">Create an Account</h3>
                                <p class="text-gray-600">Sign up in less than a minute with just your email address</p>
                            </div>
                        </div>
                        <div class="md:w-1/3 mb-6 md:mb-0 flex items-start">
                            <div class="bg-green-100 text-green-600 font-bold rounded-full w-12 h-12 flex items-center justify-center mr-4 text-xl">2</div>
                            <div>
                                <h3 class="font-bold text-xl mb-2">Start Mining</h3>
                                <p class="text-gray-600">Click the "Start Mining" button to begin earning GE Coins</p>
                            </div>
                        </div>
                        <div class="md:w-1/3 flex items-start">
                            <div class="bg-purple-100 text-purple-600 font-bold rounded-full w-12 h-12 flex items-center justify-center mr-4 text-xl">3</div>
                            <div>
                                <h3 class="font-bold text-xl mb-2">Withdraw Earnings</h3>
                                <p class="text-gray-600">Cash out your earnings to your preferred payment method</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button onclick="showAuthModal('signup')" class="gradient-bg hover:opacity-90 text-white px-8 py-4 rounded-lg font-bold text-lg transition-all">
                            <i class="fas fa-user-plus mr-2"></i> Start Mining Now
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Testimonials Section -->
        <section id="testimonials" class="mb-16">
            <div class="container mx-auto px-4">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold text-gray-800 mb-4">What Our Users Say</h2>
                    <p class="text-xl text-gray-600 max-w-3xl mx-auto">Join thousands of happy miners earning with our platform</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <div class="flex items-center mb-4">
                            <div class="avatar mr-4">
                                <i class="fas fa-user"></i>
                            </div>
                            <div>
                                <h4 class="font-bold">John D.</h4>
                                <div class="flex text-yellow-400">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                </div>
                            </div>
                        </div>
                        <p class="text-gray-600">"I've been using GE Coin Mining for 3 months and already made over $500. The withdrawals are fast and reliable!"</p>
                    </div>
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <div class="flex items-center mb-4">
                            <div class="avatar mr-4">
                                <i class="fas fa-user-tie"></i>
                            </div>
                            <div>
                                <h4 class="font-bold">Sarah M.</h4>
                                <div class="flex text-yellow-400">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                </div>
                            </div>
                        </div>
                        <p class="text-gray-600">"The referral program is amazing! I earn passive income from my referrals while also mining myself."</p>
                    </div>
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <div class="flex items-center mb-4">
                            <div class="avatar mr-4">
                                <i class="fas fa-user-astronaut"></i>
                            </div>
                            <div>
                                <h4 class="font-bold">Robert T.</h4>
                                <div class="flex text-yellow-400">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star-half-alt"></i>
                                </div>
                            </div>
                        </div>
                        <p class="text-gray-600">"Super easy to use. I'm not tech-savvy but I was able to start mining in minutes. Great platform!"</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="gradient-bg text-white rounded-xl shadow-xl p-12 text-center mb-16">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl font-bold mb-6">Ready to Start Earning?</h2>
                <p class="text-xl mb-8 max-w-2xl mx-auto">Join thousands of users who are already mining GE Coins and earning real money</p>
                <button onclick="showAuthModal('signup')" class="bg-white hover:bg-gray-100 text-blue-600 px-8 py-4 rounded-lg font-bold text-lg transition-all">
                    <i class="fas fa-user-plus mr-2"></i> Sign Up Now - It's Free!
                </button>
            </div>
        </section>
    </div>

    <!-- Dashboard Content (Hidden by default) -->
    <div id="dashboardContent" class="hidden">
        <div class="container mx-auto px-4 py-8">
            <!-- Mining Section -->
            <section id="mining" class="mb-12 py-8 bg-gray-50 rounded-xl">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2"><i class="fas fa-digging mr-2"></i> GE Coin Mining</h2>
                    <p class="text-gray-600">Start mining now and earn GE Coins automatically</p>
                </div>
                
                <div class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden p-6 text-center">
                    <div class="mb-6">
                        <div class="relative">
                            <div class="mining-avatar mining-animation">
                                <i class="fas fa-coins"></i>
                            </div>
                            <div class="absolute top-4 left-4 bg-green-500 text-white px-3 py-1 rounded-full text-sm">
                                <i class="fas fa-play mr-1"></i> Active
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="bg-gray-100 p-4 rounded-lg">
                            <p class="text-gray-500 text-sm">Mining Rate</p>
                            <p id="miningRate" class="font-bold text-lg">0.000002 GE/s</p>
                        </div>
                        <div class="bg-gray-100 p-4 rounded-lg">
                            <p class="text-gray-500 text-sm">Current Balance</p>
                            <p id="currentBalance" class="font-bold text-lg">0 GE</p>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <div class="flex justify-between text-sm text-gray-500 mb-1">
                            <span>Mining Progress</span>
                            <span id="miningProgressText">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div id="miningProgressBar" class="gradient-bg h-2.5 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-blue-50 p-3 rounded-lg">
                            <p class="text-gray-500 text-sm">Today's Earnings</p>
                            <p id="todayEarnings" class="font-bold">0 GE ($0.00)</p>
                        </div>
                        <div class="bg-green-50 p-3 rounded-lg">
                            <p class="text-gray-500 text-sm">Total Earnings</p>
                            <p id="totalEarnings" class="font-bold">0 GE ($0.00)</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Profile Section -->
            <section id="profile" class="mb-12">
                <h2 class="text-2xl font-bold text-gray-800 mb-6"><i class="fas fa-user mr-2"></i> My Profile</h2>
                
                <div class="bg-white rounded-xl shadow-md overflow-hidden mb-6">
                    <div class="p-6">
                        <div class="flex flex-col md:flex-row items-start">
                            <div class="md:w-1/3 mb-6 md:mb-0 flex flex-col items-center">
                                <div class="avatar text-4xl mb-4">
                                    <i class="fas fa-user"></i>
                                </div>
                                <h3 id="profileUsername" class="font-bold text-xl"></h3>
                                <p id="profileStatus" class="status-badge status-approved mt-2">Active</p>
                            </div>
                            <div class="md:w-2/3">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-gray-500 mb-1">Email</label>
                                        <p id="profileEmail" class="font-medium"></p>
                                    </div>
                                    <div>
                                        <label class="block text-gray-500 mb-1">Joined Date</label>
                                        <p id="profileJoined" class="font-medium"></p>
                                    </div>
                                    <div>
                                        <label class="block text-gray-500 mb-1">Last Active</label>
                                        <p id="profileLastActive" class="font-medium"></p>
                                    </div>
                                    <div>
                                        <label class="block text-gray-500 mb-1">Referral Code</label>
                                        <p id="profileReferralCode" class="font-medium"></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <i class="fas fa-coins text-yellow-500 mr-2"></i> Balance
                        </h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-500">Available:</span>
                                <span id="profileBalance" class="font-bold">0 GE</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-500">Total Earned:</span>
                                <span id="profileTotalEarned" class="font-bold">0 GE</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-500">Total Withdrawn:</span>
                                <span id="profileTotalWithdrawn" class="font-bold">0 GE</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <i class="fas fa-users text-green-500 mr-2"></i> Referral Stats
                        </h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-500">Referrals:</span>
                                <span id="profileReferrals" class="font-bold">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-500">Referral Earnings:</span>
                                <span id="profileReferralEarnings" class="font-bold">0 GE</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-500">Referral Link:</span>
                                <button onclick="copyReferralLink()" class="text-blue-600 hover:text-blue-800 text-sm">
                                    <i class="fas fa-copy"></i> Copy
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <i class="fas fa-cog text-purple-500 mr-2"></i> Settings
                        </h3>
                        <button onclick="showUpdatePasswordModal()" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 py-2 rounded-lg mb-2 transition-all">
                            <i class="fas fa-key mr-2"></i> Change Password
                        </button>
                        <button onclick="showUpdatePaymentModal()" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 py-2 rounded-lg transition-all">
                            <i class="fas fa-wallet mr-2"></i> Payment Method
                        </button>
                    </div>
                </div>
            </section>

            <!-- Referral Section -->
            <section id="refer" class="mb-12">
                <h2 class="text-2xl font-bold text-gray-800 mb-6"><i class="fas fa-users mr-2"></i> Referral Program</h2>
                
                <div class="bg-white rounded-xl shadow-md p-6 mb-6">
                    <div class="flex flex-col md:flex-row items-center">
                        <div class="md:w-1/2 mb-6 md:mb-0">
                            <h3 class="text-xl font-bold text-gray-800 mb-2">Invite Friends & Earn 10%</h3>
                            <p class="text-gray-600 mb-4">Share your referral link and earn 10% of your friends' mining rewards for life!</p>
                            
                            <div class="mb-4">
                                <label class="block text-gray-700 mb-2 font-medium">Your Referral Link</label>
                                <div class="flex">
                                    <input type="text" id="referralLink" class="flex-1 p-2 border border-gray-300 rounded-l-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" readonly>
                                    <button onclick="copyReferralLink()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 rounded-r-lg">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="flex space-x-2">
                                <button onclick="shareOnFacebook()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
                                    <i class="fab fa-facebook-f mr-1"></i> Share
                                </button>
                                <button onclick="shareOnWhatsApp()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg">
                                    <i class="fab fa-whatsapp mr-1"></i> Share
                                </button>
                            </div>
                        </div>
                        <div class="md:w-1/2 flex justify-center">
                            <div class="bg-blue-50 p-6 rounded-lg">
                                <div class="text-center mb-4">
                                    <i class="fas fa-gift text-4xl text-blue-500 mb-2"></i>
                                    <h4 class="font-bold">Referral Bonus</h4>
                                </div>
                                <div class="text-center">
                                    <p class="text-3xl font-bold text-blue-600 mb-1">10%</p>
                                    <p class="text-gray-600">of your referrals' earnings</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h3 class="font-bold text-lg mb-4 flex items-center">
                        <i class="fas fa-user-friends text-green-500 mr-2"></i> Your Referrals
                    </h3>
                    
                    <div id="referralStats" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-gray-100 p-4 rounded-lg text-center">
                            <p class="text-gray-500 text-sm">Total Referrals</p>
                            <p id="totalReferrals" class="font-bold text-xl">0</p>
                        </div>
                        <div class="bg-gray-100 p-4 rounded-lg text-center">
                            <p class="text-gray-500 text-sm">Active Referrals</p>
                            <p id="activeReferrals" class="font-bold text-xl">0</p>
                        </div>
                        <div class="bg-gray-100 p-4 rounded-lg text-center">
                            <p class="text-gray-500 text-sm">Referral Earnings</p>
                            <p id="totalReferralEarnings" class="font-bold text-xl">0 GE</p>
                        </div>
                        <div class="bg-gray-100 p-4 rounded-lg text-center">
                            <p class="text-gray-500 text-sm">Last Referral</p>
                            <p id="lastReferral" class="font-bold">None</p>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white">
                            <thead>
                                <tr class="border-b">
                                    <th class="py-3 px-4 text-left">Username</th>
                                    <th class="py-3 px-4 text-left">Joined</th>
                                    <th class="py-3 px-4 text-left">Status</th>
                                    <th class="py-3 px-4 text-left">Earned</th>
                                </tr>
                            </thead>
                            <tbody id="referralList">
                                <tr>
                                    <td colspan="4" class="py-4 text-center text-gray-500">No referrals yet</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Withdraw Section -->
            <section id="withdraw" class="mb-12">
                <h2 class="text-2xl font-bold text-gray-800 mb-6"><i class="fas fa-money-bill-wave mr-2"></i> Withdraw Earnings</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <i class="fas fa-wallet text-green-500 mr-2"></i> Balance
                        </h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-500">Available:</span>
                                <span id="withdrawBalance" class="font-bold">0 GE ($0.00)</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-500">Minimum Withdrawal:</span>
                                <span class="font-bold">10 GE ($5.00)</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-500">Withdrawal Fee:</span>
                                <span class="font-bold">5%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-md p-6 md:col-span-2">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <i class="fas fa-coins text-yellow-500 mr-2"></i> Request Withdrawal
                        </h3>
                        
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2 font-medium">Payment Method</label>
                            <select id="withdrawMethod" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                                <option value="bkash">bKash</option>
                                <option value="nagad">Nagad</option>
                                <option value="rocket">Rocket</option>
                            </select>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2 font-medium">Account Number</label>
                            <input type="text" id="withdrawAccount" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Enter your account number">
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2 font-medium">Amount (GE)</label>
                            <input type="number" id="withdrawAmount" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Enter amount to withdraw">
                            <p class="text-sm text-gray-500 mt-1">Minimum: 10 GE ($5.00)</p>
                        </div>
                        
                        <button onclick="requestWithdrawal()" id="withdrawBtn" class="w-full gradient-bg hover:opacity-90 text-white py-3 rounded-lg font-bold transition-all flex items-center justify-center">
                            <span id="withdrawText">Request Withdrawal</span>
                            <div id="withdrawSpinner" class="loading-spinner ml-2 hidden"></div>
                        </button>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h3 class="font-bold text-lg mb-4 flex items-center">
                        <i class="fas fa-history text-blue-500 mr-2"></i> Withdrawal History
                    </h3>
                    
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white">
                            <thead>
                                <tr class="border-b">
                                    <th class="py-3 px-4 text-left">Date</th>
                                    <th class="py-3 px-4 text-left">Method</th>
                                    <th class="py-3 px-4 text-left">Amount</th>
                                    <th class="py-3 px-4 text-left">Status</th>
                                </tr>
                            </thead>
                            <tbody id="withdrawalHistory">
                                <tr>
                                    <td colspan="4" class="py-4 text-center text-gray-500">No withdrawal history</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Footer -->
    <footer class="gradient-bg text-white py-8">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-6 md:mb-0">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-coins text-yellow-300 text-2xl"></i>
                        <span class="font-bold text-xl">GE Coin Mining</span>
                    </div>
                    <p class="mt-2">The easiest way to earn cryptocurrency</p>
                </div>
                <div class="flex space-x-6">
                    <a href="#" class="hover:text-yellow-300 transition">Terms of Service</a>
                    <a href="#" class="hover:text-yellow-300 transition">Privacy Policy</a>
                    <a href="#" class="hover:text-yellow-300 transition">Contact Support</a>
                </div>
            </div>
            <div class="mt-8 pt-6 border-t border-white border-opacity-20 text-center text-sm">
                <p>&copy; 2023 GE Coin Mining. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Auth Modal -->
    <div id="authModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50 p-4">
        <div class="bg-white rounded-xl p-6 w-full max-w-md animate-fadeIn">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold text-xl flex items-center">
                    <i class="fas fa-user-circle text-blue-500 mr-2"></i>
                    <span id="authModalTitle">Login</span>
                </h3>
                <button onclick="hideAuthModal()" class="text-gray-500 hover:text-gray-700 transition-all">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="loginForm">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2 font-medium">Username</label>
                    <input type="text" id="loginUsername" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2 font-medium">Password</label>
                    <input type="password" id="loginPassword" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <button onclick="userLogin()" id="loginBtn" class="w-full gradient-bg hover:opacity-90 text-white py-3 rounded-lg font-bold transition-all flex items-center justify-center">
                    <span id="loginText">Login</span>
                    <div id="loginSpinner" class="loading-spinner ml-2 hidden"></div>
                </button>
                <p class="text-center mt-4 text-gray-600">
                    Don't have an account? 
                    <button onclick="showSignupForm()" class="text-blue-600 hover:text-blue-800 font-medium">Sign up</button>
                </p>
            </div>
            <div id="signupForm" class="hidden">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2 font-medium">Username</label>
                    <input type="text" id="signupUsername" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2 font-medium">Email</label>
                    <input type="email" id="signupEmail" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2 font-medium">Password</label>
                    <input type="password" id="signupPassword" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2 font-medium">Referral Code (Optional)</label>
                    <input type="text" id="signupReferral" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <button onclick="userSignup()" id="signupBtn" class="w-full gradient-bg hover:opacity-90 text-white py-3 rounded-lg font-bold transition-all flex items-center justify-center">
                    <span id="signupText">Sign Up</span>
                    <div id="signupSpinner" class="loading-spinner ml-2 hidden"></div>
                </button>
                <p class="text-center mt-4 text-gray-600">
                    Already have an account? 
                    <button onclick="showLoginForm()" class="text-blue-600 hover:text-blue-800 font-medium">Login</button>
                </p>
            </div>
        </div>
    </div>

    <!-- Update Password Modal -->
    <div id="updatePasswordModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50 p-4">
        <div class="bg-white rounded-xl p-6 w-full max-w-md animate-fadeIn">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold text-xl flex items-center">
                    <i class="fas fa-key text-blue-500 mr-2"></i> Change Password
                </h3>
                <button onclick="hideUpdatePasswordModal()" class="text-gray-500 hover:text-gray-700 transition-all">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 mb-2 font-medium">Current Password</label>
                <input type="password" id="currentPassword" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 mb-2 font-medium">New Password</label>
                <input type="password" id="newPassword" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 mb-2 font-medium">Confirm New Password</label>
                <input type="password" id="confirmPassword" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
            </div>
            <div class="flex space-x-3">
                <button onclick="hideUpdatePasswordModal()" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 py-3 rounded-lg font-bold transition-all">
                    Cancel
                </button>
                <button onclick="updatePassword()" id="updatePasswordBtn" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-bold transition-all flex items-center justify-center">
                    <span id="updatePasswordText">Update</span>
                    <div id="updatePasswordSpinner" class="loading-spinner ml-2 hidden"></div>
                </button>
            </div>
        </div>
    </div>

    <!-- Update Payment Modal -->
    <div id="updatePaymentModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50 p-4">
        <div class="bg-white rounded-xl p-6 w-full max-w-md animate-fadeIn">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold text-xl flex items-center">
                    <i class="fas fa-wallet text-green-500 mr-2"></i> Payment Method
                </h3>
                <button onclick="hideUpdatePaymentModal()" class="text-gray-500 hover:text-gray-700 transition-all">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 mb-2 font-medium">Payment Method</label>
                <select id="paymentMethod" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                    <option value="bkash">bKash</option>
                    <option value="nagad">Nagad</option>
                    <option value="rocket">Rocket</option>
                </select>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 mb-2 font-medium">Account Number</label>
                <input type="text" id="paymentAccount" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Enter your account number">
            </div>
            <div class="flex space-x-3">
                <button onclick="hideUpdatePaymentModal()" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 py-3 rounded-lg font-bold transition-all">
                    Cancel
                </button>
                <button onclick="updatePaymentMethod()" id="updatePaymentBtn" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-bold transition-all flex items-center justify-center">
                    <span id="updatePaymentText">Save</span>
                    <div id="updatePaymentSpinner" class="loading-spinner ml-2 hidden"></div>
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-6 rounded-lg shadow-xl flex flex-col items-center">
            <div class="loading-spinner mb-4" style="width: 40px; height: 40px; border-width: 4px;"></div>
            <p class="text-gray-700 font-medium">Loading...</p>
        </div>
    </div>

    <!-- Firebase configuration -->
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDX7Z8o5xVJa8cSHvaurZg4FkJvN8mJuto",
            authDomain: "free-fire-kingdom.firebaseapp.com",
            databaseURL: "https://free-fire-kingdom-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "free-fire-kingdom",
            storageBucket: "free-fire-kingdom.appspot.com",
            messagingSenderId: "889375613179",
            appId: "1:889375613179:web:b36bd72dd208b101e0d05e",
            measurementId: "G-0EWSZ3SFX1"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // App variables
        let currentUser = null;
        let miningInterval = null;
        let miningRate = 0.000002; // GE per second
        let coinValue = 0.5; // $0.5 per GE coin
        let minWithdrawal = 10; // 10 GE ($5)
        let withdrawalFee = 0.05; // 5%
        let referralBonus = 0.1; // 10%

        // Show auth modal
        function showAuthModal(type) {
            if (type === 'login') {
                document.getElementById('authModalTitle').textContent = 'Login';
                document.getElementById('loginForm').classList.remove('hidden');
                document.getElementById('signupForm').classList.add('hidden');
            } else {
                document.getElementById('authModalTitle').textContent = 'Sign Up';
                document.getElementById('loginForm').classList.add('hidden');
                document.getElementById('signupForm').classList.remove('hidden');
            }
            document.getElementById('authModal').classList.remove('hidden');
        }

        // Hide auth modal
        function hideAuthModal() {
            document.getElementById('authModal').classList.add('hidden');
        }

        // Toggle between login/signup forms
        function showLoginForm() {
            document.getElementById('authModalTitle').textContent = 'Login';
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('signupForm').classList.add('hidden');
        }

        function showSignupForm() {
            document.getElementById('authModalTitle').textContent = 'Sign Up';
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('signupForm').classList.remove('hidden');
        }

        // Check if user is logged in
        function checkAuth() {
            const user = localStorage.getItem('miningUser');
            if (user) {
                currentUser = JSON.parse(user);
                showDashboard();
                startMining();
                loadUserData();
            } else {
                showHomepage();
            }
        }

        // Show homepage
        function showHomepage() {
            document.getElementById('homeContent').classList.remove('hidden');
            document.getElementById('dashboardContent').classList.add('hidden');
            document.getElementById('navLinks').innerHTML = `
                <a href="#home" class="hover:text-yellow-300 transition"><i class="fas fa-home mr-1"></i> Home</a>
                <a href="#features" class="hover:text-yellow-300 transition"><i class="fas fa-star mr-1"></i> Features</a>
                <a href="#how-it-works" class="hover:text-yellow-300 transition"><i class="fas fa-question-circle mr-1"></i> How It Works</a>
            `;
            document.getElementById('authButtons').innerHTML = `
                <button onclick="showAuthModal('login')" class="bg-white hover:bg-gray-100 text-blue-600 px-4 py-2 rounded-lg font-bold transition-all">
                    <i class="fas fa-sign-in-alt mr-2"></i> Login
                </button>
                <button onclick="showAuthModal('signup')" class="bg-yellow-400 hover:bg-yellow-500 text-gray-800 px-4 py-2 rounded-lg font-bold transition-all">
                    <i class="fas fa-user-plus mr-2"></i> Sign Up
                </button>
            `;
        }

        // Show dashboard
        function showDashboard() {
            document.getElementById('homeContent').classList.add('hidden');
            document.getElementById('dashboardContent').classList.remove('hidden');
            document.getElementById('navLinks').innerHTML = `
                <a href="#mining" class="hover:text-yellow-300 transition"><i class="fas fa-digging mr-1"></i> Mining</a>
                <a href="#profile" class="hover:text-yellow-300 transition"><i class="fas fa-user mr-1"></i> Profile</a>
                <a href="#refer" class="hover:text-yellow-300 transition"><i class="fas fa-users mr-1"></i> Referral</a>
                <a href="#withdraw" class="hover:text-yellow-300 transition"><i class="fas fa-money-bill-wave mr-1"></i> Withdraw</a>
            `;
            document.getElementById('authButtons').innerHTML = `
                <div class="hidden md:flex items-center bg-white bg-opacity-20 px-3 py-1 rounded-full">
                    <i class="fas fa-coins text-yellow-300 mr-2"></i>
                    <span id="headerBalance">0 GE</span>
                </div>
                <button onclick="userLogout()" class="bg-white hover:bg-gray-100 text-blue-600 px-4 py-2 rounded-lg font-bold transition-all">
                    <i class="fas fa-sign-out-alt mr-2"></i> Logout
                </button>
            `;
        }

        // User login
        function userLogin() {
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            
            if (!username || !password) {
                alert("Please enter both username and password");
                return;
            }
            
            // Show loading
            document.getElementById('loginText').classList.add('hidden');
            document.getElementById('loginSpinner').classList.remove('hidden');
            document.getElementById('loginBtn').disabled = true;
            
            // Check user in database
            db.ref('users/' + username).once('value').then(snap => {
                const user = snap.val();
                
                if (!user || user.password !== password) {
                    throw new Error("Invalid username or password");
                }
                
                if (user.status === 'banned') {
                    throw new Error("Your account has been banned. Please contact support.");
                }
                
                // Update last login
                return db.ref('users/' + username).update({
                    lastLogin: Date.now(),
                    lastActivity: Date.now()
                }).then(() => {
                    // Store user data in localStorage
                    localStorage.setItem('miningUser', JSON.stringify(user));
                    currentUser = user;
                    // Hide modal and show dashboard
                    hideAuthModal();
                    showDashboard();
                    startMining();
                    loadUserData();
                });
            }).catch(error => {
                alert(error.message);
            }).finally(() => {
                // Reset button
                document.getElementById('loginText').classList.remove('hidden');
                document.getElementById('loginSpinner').classList.add('hidden');
                document.getElementById('loginBtn').disabled = false;
            });
        }

        // User signup
        function userSignup() {
            const username = document.getElementById('signupUsername').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value.trim();
            const referralCode = document.getElementById('signupReferral').value.trim();
            
            if (!username || !email || !password) {
                alert("Please fill all required fields");
                return;
            }
            
            if (password.length < 6) {
                alert("Password must be at least 6 characters");
                return;
            }
            
            // Show loading
            document.getElementById('signupText').classList.add('hidden');
            document.getElementById('signupSpinner').classList.remove('hidden');
            document.getElementById('signupBtn').disabled = true;
            
            // Check if username exists
            db.ref('users/' + username).once('value').then(snap => {
                if (snap.exists()) {
                    throw new Error("Username already exists");
                }
                
                // Generate referral code
                const newReferralCode = generateReferralCode(username);
                
                // Create user object
                const user = {
                    username: username,
                    email: email,
                    password: password,
                    balance: 0,
                    totalEarned: 0,
                    totalWithdrawn: 0,
                    referralCode: newReferralCode,
                    referredBy: referralCode || null,
                    referralEarnings: 0,
                    tasksCompleted: 0,
                    status: "active",
                    joinedAt: Date.now(),
                    lastActivity: Date.now(),
                    lastLogin: Date.now(),
                    paymentMethod: null,
                    paymentAccount: null
                };
                
                // Save user
                return db.ref('users/' + username).set(user).then(() => {
                    return user;
                });
            }).then(user => {
                // If referred by someone, update their referrals
                if (user.referredBy) {
                    return db.ref('users').orderByChild('referralCode').equalTo(user.referredBy).once('value').then(snap => {
                        const referrer = snap.val();
                        if (referrer) {
                            const referrerUsername = Object.keys(referrer)[0];
                            return db.ref('users/' + referrerUsername).update({
                                referrals: (referrer[referrerUsername].referrals || 0) + 1
                            });
                        }
                    }).then(() => {
                        return user;
                    });
                }
                return user;
            }).then(user => {
                // Store user data in localStorage
                localStorage.setItem('miningUser', JSON.stringify(user));
                currentUser = user;
                // Hide modal and show dashboard
                hideAuthModal();
                showDashboard();
                startMining();
                loadUserData();
            }).catch(error => {
                alert(error.message);
            }).finally(() => {
                // Reset button
                document.getElementById('signupText').classList.remove('hidden');
                document.getElementById('signupSpinner').classList.add('hidden');
                document.getElementById('signupBtn').disabled = false;
            });
        }

        // User logout
        function userLogout() {
            if (currentUser) {
                // Record logout activity
                db.ref('userLogs/' + Date.now()).set({
                    user: currentUser.username,
                    action: "logout",
                    timestamp: Date.now()
                });
                
                // Stop mining
                stopMining();
                
                // Clear user data
                currentUser = null;
                localStorage.removeItem('miningUser');
                
                // Show homepage
                showHomepage();
            }
        }

        // Generate referral code
        function generateReferralCode(username) {
            const randomNum = Math.floor(1000 + Math.random() * 9000);
            return username.slice(0, 3).toUpperCase() + randomNum;
        }

        // Start mining
        function startMining() {
            if (!currentUser || miningInterval) return;
            
            // Update mining rate display
            document.getElementById('miningRate').textContent = miningRate.toFixed(6) + ' GE/s';
            
            // Start mining interval
            let progress = 0;
            miningInterval = setInterval(() => {
                // Update progress bar
                progress = (progress + 1) % 100;
                document.getElementById('miningProgressBar').style.width = progress + '%';
                document.getElementById('miningProgressText').textContent = progress + '%';
                
                // Add coins to balance (every second)
                if (progress % 10 === 0) {
                    addMiningReward();
                }
            }, 100);
        }

        // Stop mining
        function stopMining() {
            if (miningInterval) {
                clearInterval(miningInterval);
                miningInterval = null;
            }
        }

        // Add mining reward to user balance
        function addMiningReward() {
            if (!currentUser) return;
            
            const reward = miningRate;
            
            // Update user balance in database
            db.ref('users/' + currentUser.username).transaction(user => {
                if (user) {
                    user.balance = (user.balance || 0) + reward;
                    user.totalEarned = (user.totalEarned || 0) + reward;
                    user.lastActivity = Date.now();
                    
                    // If user was referred by someone, add referral bonus
                    if (user.referredBy) {
                        db.ref('users').orderByChild('referralCode').equalTo(user.referredBy).once('value').then(snap => {
                            const referrer = snap.val();
                            if (referrer) {
                                const referrerUsername = Object.keys(referrer)[0];
                                const referralReward = reward * referralBonus;
                                
                                // Update referrer's balance
                                db.ref('users/' + referrerUsername).transaction(refUser => {
                                    if (refUser) {
                                        refUser.balance = (refUser.balance || 0) + referralReward;
                                        refUser.referralEarnings = (refUser.referralEarnings || 0) + referralReward;
                                        refUser.totalEarned = (refUser.totalEarned || 0) + referralReward;
                                    }
                                    return refUser;
                                });
                            }
                        });
                    }
                }
                return user;
            }).then(() => {
                // Update UI
                loadUserData();
            });
        }

        // Load user data
        function loadUserData() {
            if (!currentUser) return;
            
            showLoading();
            
            // Get updated user data
            db.ref('users/' + currentUser.username).once('value').then(snap => {
                const user = snap.val();
                if (!user) return;
                
                currentUser = {
                    ...currentUser,
                    ...user
                };
                
                // Save to localStorage
                localStorage.setItem('miningUser', JSON.stringify(currentUser));
                
                // Update profile info
                document.getElementById('profileUsername').textContent = user.username;
                document.getElementById('profileEmail').textContent = user.email || 'Not set';
                document.getElementById('profileJoined').textContent = formatDate(user.joinedAt);
                document.getElementById('profileLastActive').textContent = formatDate(user.lastActivity);
                document.getElementById('profileReferralCode').textContent = user.referralCode || 'N/A';
                
                // Update status badge
                const statusBadge = document.getElementById('profileStatus');
                statusBadge.className = 'status-badge ' + (user.status === 'active' ? 'status-approved' : 'status-pending');
                statusBadge.textContent = user.status || 'active';
                
                // Update balance displays
                document.getElementById('currentBalance').textContent = user.balance.toFixed(6) + ' GE';
                document.getElementById('profileBalance').textContent = user.balance.toFixed(6) + ' GE';
                document.getElementById('profileTotalEarned').textContent = user.totalEarned.toFixed(6) + ' GE';
                document.getElementById('profileTotalWithdrawn').textContent = user.totalWithdrawn.toFixed(6) + ' GE';
                document.getElementById('withdrawBalance').textContent = user.balance.toFixed(6) + ' GE ($' + (user.balance * coinValue).toFixed(2) + ')';
                document.getElementById('headerBalance').textContent = user.balance.toFixed(6) + ' GE';
                
                // Update today's earnings (simplified - in real app would calculate from logs)
                document.getElementById('todayEarnings').textContent = (miningRate * 60 * 60 * 24).toFixed(6) + ' GE ($' + (miningRate * 60 * 60 * 24 * coinValue).toFixed(2) + ')';
                document.getElementById('totalEarnings').textContent = user.totalEarned.toFixed(6) + ' GE ($' + (user.totalEarned * coinValue).toFixed(2) + ')';
                
                // Update referral stats
                document.getElementById('profileReferralEarnings').textContent = user.referralEarnings.toFixed(6) + ' GE';
                document.getElementById('profileReferrals').textContent = user.referrals || '0';
                
                // Update referral link
                document.getElementById('referralLink').value = window.location.origin + '/index.html?ref=' + user.referralCode;
                
                // Load referrals list
                if (user.referralCode) {
                    return db.ref('users').orderByChild('referredBy').equalTo(user.referralCode).once('value').then(snap => {
                        const referrals = snap.val() || {};
                        const referralList = document.getElementById('referralList');
                        referralList.innerHTML = '';
                        
                        if (Object.keys(referrals).length === 0) {
                            referralList.innerHTML = `
                                <tr>
                                    <td colspan="4" class="py-4 text-center text-gray-500">No referrals yet</td>
                                </tr>
                            `;
                        } else {
                            Object.keys(referrals).forEach(username => {
                                const refUser = referrals[username];
                                const tr = document.createElement('tr');
                                tr.className = "border-b";
                                tr.innerHTML = `
                                    <td class="py-3 px-4">${username}</td>
                                    <td class="py-3 px-4">${formatDate(refUser.joinedAt)}</td>
                                    <td class="py-3 px-4">
                                        <span class="status-badge ${refUser.status === 'active' ? 'status-approved' : 'status-pending'}">
                                            ${refUser.status || 'active'}
                                        </span>
                                    </td>
                                    <td class="py-3 px-4">${(refUser.totalEarned * referralBonus).toFixed(6)} GE</td>
                                `;
                                referralList.appendChild(tr);
                            });
                        }
                        
                        // Update referral stats
                        document.getElementById('totalReferrals').textContent = Object.keys(referrals).length;
                        document.getElementById('activeReferrals').textContent = Object.values(referrals).filter(u => u.status === 'active').length;
                        document.getElementById('totalReferralEarnings').textContent = user.referralEarnings.toFixed(6) + ' GE';
                        
                        const lastReferral = Object.values(referrals).sort((a, b) => b.joinedAt - a.joinedAt)[0];
                        document.getElementById('lastReferral').textContent = lastReferral ? formatDate(lastReferral.joinedAt) : 'None';
                    });
                }
            }).then(() => {
                // Load withdrawal history
                return db.ref('withdrawals').orderByChild('user').equalTo(currentUser.username).once('value').then(snap => {
                    const withdrawals = snap.val() || {};
                    const historyTable = document.getElementById('withdrawalHistory');
                    historyTable.innerHTML = '';
                    
                    if (Object.keys(withdrawals).length === 0) {
                        historyTable.innerHTML = `
                            <tr>
                                <td colspan="4" class="py-4 text-center text-gray-500">No withdrawal history</td>
                            </tr>
                        `;
                    } else {
                        Object.keys(withdrawals).reverse().forEach(id => {
                            const withdrawal = withdrawals[id];
                            const tr = document.createElement('tr');
                            tr.className = "border-b";
                            tr.innerHTML = `
                                <td class="py-3 px-4">${formatDate(withdrawal.requestedAt)}</td>
                                <td class="py-3 px-4">${withdrawal.method.toUpperCase()}</td>
                                <td class="py-3 px-4">${withdrawal.amount} GE ($${(withdrawal.amount * coinValue).toFixed(2)})</td>
                                <td class="py-3 px-4">
                                    <span class="status-badge ${withdrawal.status === 'approved' ? 'status-approved' : 
                                        withdrawal.status === 'rejected' ? 'status-rejected' : 'status-pending'}">
                                        ${withdrawal.status}
                                    </span>
                                </td>
                            `;
                            historyTable.appendChild(tr);
                        });
                    }
                });
            }).catch(error => {
                console.error("Error loading user data:", error);
            }).finally(() => {
                hideLoading();
            });
        }

        // Copy referral link
        function copyReferralLink() {
            if (!currentUser) return;
            
            const referralLink = document.getElementById('referralLink');
            referralLink.select();
            document.execCommand('copy');
            
            alert("Referral link copied to clipboard!");
        }

        // Share on Facebook
        function shareOnFacebook() {
            if (!currentUser) return;
            
            const link = document.getElementById('referralLink').value;
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(link)}`, '_blank');
        }

        // Share on WhatsApp
        function shareOnWhatsApp() {
            if (!currentUser) return;
            
            const link = document.getElementById('referralLink').value;
            const text = `Join GE Coin Mining and start earning cryptocurrency! Use my referral link: ${link}`;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
        }

        // Request withdrawal
        function requestWithdrawal() {
            if (!currentUser) return;
            
            const method = document.getElementById('withdrawMethod').value;
            const account = document.getElementById('withdrawAccount').value.trim();
            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            
            if (!method || !account) {
                alert("Please select payment method and enter account number");
                return;
            }
            
            if (!amount || amount < minWithdrawal) {
                alert(`Minimum withdrawal amount is ${minWithdrawal} GE ($${(minWithdrawal * coinValue).toFixed(2)})`);
                return;
            }
            
            if (amount > currentUser.balance) {
                alert("Insufficient balance");
                return;
            }
            
            // Calculate fee and net amount
            const fee = amount * withdrawalFee;
            const netAmount = amount - fee;
            
            if (confirm(`Request withdrawal of ${amount} GE ($${(amount * coinValue).toFixed(2)})?\nFee: ${fee.toFixed(6)} GE ($${(fee * coinValue).toFixed(2)})\nYou will receive: ${netAmount.toFixed(6)} GE ($${(netAmount * coinValue).toFixed(2)})`)) {
                // Show loading
                document.getElementById('withdrawText').classList.add('hidden');
                document.getElementById('withdrawSpinner').classList.remove('hidden');
                document.getElementById('withdrawBtn').disabled = true;
                
                // Create withdrawal request
                const withdrawalId = Date.now();
                const withdrawal = {
                    user: currentUser.username,
                    method: method,
                    account: account,
                    amount: amount,
                    fee: fee,
                    netAmount: netAmount,
                    status: "pending",
                    requestedAt: Date.now(),
                    processedAt: null,
                    processedBy: null
                };
                
                // Save withdrawal request
                db.ref('withdrawals/' + withdrawalId).set(withdrawal).then(() => {
                    // Deduct from user balance
                    return db.ref('users/' + currentUser.username).update({
                        balance: currentUser.balance - amount,
                        totalWithdrawn: (currentUser.totalWithdrawn || 0) + amount,
                        lastActivity: Date.now()
                    });
                }).then(() => {
                    // Update UI
                    loadUserData();
                    alert("Withdrawal request submitted successfully! It will be processed within 24 hours.");
                    
                    // Record activity
                    db.ref('userLogs/' + Date.now()).set({
                        user: currentUser.username,
                        action: "withdrawal_request",
                        details: `Requested withdrawal of ${amount} GE`,
                        timestamp: Date.now()
                    });
                }).catch(error => {
                    alert("Error submitting withdrawal request: " + error.message);
                }).finally(() => {
                    // Reset button
                    document.getElementById('withdrawText').classList.remove('hidden');
                    document.getElementById('withdrawSpinner').classList.add('hidden');
                    document.getElementById('withdrawBtn').disabled = false;
                });
            }
        }

        // Show update password modal
        function showUpdatePasswordModal() {
            document.getElementById('currentPassword').value = "";
            document.getElementById('newPassword').value = "";
            document.getElementById('confirmPassword').value = "";
            document.getElementById('updatePasswordModal').classList.remove('hidden');
        }

        // Hide update password modal
        function hideUpdatePasswordModal() {
            document.getElementById('updatePasswordModal').classList.add('hidden');
        }

        // Update password
        function updatePassword() {
            if (!currentUser) return;
            
            const currentPass = document.getElementById('currentPassword').value;
            const newPass = document.getElementById('newPassword').value;
            const confirmPass = document.getElementById('confirmPassword').value;
            
            if (!currentPass || !newPass || !confirmPass) {
                alert("Please fill all fields");
                return;
            }
            
            if (newPass !== confirmPass) {
                alert("New passwords don't match");
                return;
            }
            
            if (newPass.length < 6) {
                alert("Password must be at least 6 characters");
                return;
            }
            
            // Show loading
            document.getElementById('updatePasswordText').classList.add('hidden');
            document.getElementById('updatePasswordSpinner').classList.remove('hidden');
            document.getElementById('updatePasswordBtn').disabled = true;
            
            // Verify current password
            db.ref('users/' + currentUser.username).once('value').then(snap => {
                const user = snap.val();
                if (!user || user.password !== currentPass) {
                    throw new Error("Current password is incorrect");
                }
                
                // Update password
                return db.ref('users/' + currentUser.username).update({
                    password: newPass,
                    lastActivity: Date.now()
                });
            }).then(() => {
                // Update local user data
                currentUser.password = newPass;
                localStorage.setItem('miningUser', JSON.stringify(currentUser));
                
                // Hide modal and show success
                hideUpdatePasswordModal();
                alert("Password updated successfully!");
                
                // Record activity
                db.ref('userLogs/' + Date.now()).set({
                    user: currentUser.username,
                    action: "password_change",
                    timestamp: Date.now()
                });
            }).catch(error => {
                alert(error.message);
            }).finally(() => {
                // Reset button
                document.getElementById('updatePasswordText').classList.remove('hidden');
                document.getElementById('updatePasswordSpinner').classList.add('hidden');
                document.getElementById('updatePasswordBtn').disabled = false;
            });
        }

        // Show update payment modal
        function showUpdatePaymentModal() {
            document.getElementById('paymentMethod').value = currentUser.paymentMethod || 'bkash';
            document.getElementById('paymentAccount').value = currentUser.paymentAccount || '';
            document.getElementById('updatePaymentModal').classList.remove('hidden');
        }

        // Hide update payment modal
        function hideUpdatePaymentModal() {
            document.getElementById('updatePaymentModal').classList.add('hidden');
        }

        // Update payment method
        function updatePaymentMethod() {
            if (!currentUser) return;
            
            const method = document.getElementById('paymentMethod').value;
            const account = document.getElementById('paymentAccount').value.trim();
            
            if (!method || !account) {
                alert("Please select payment method and enter account number");
                return;
            }
            
            // Show loading
            document.getElementById('updatePaymentText').classList.add('hidden');
            document.getElementById('updatePaymentSpinner').classList.remove('hidden');
            document.getElementById('updatePaymentBtn').disabled = true;
            
            // Update payment method
            db.ref('users/' + currentUser.username).update({
                paymentMethod: method,
                paymentAccount: account,
                lastActivity: Date.now()
            }).then(() => {
                // Update local user data
                currentUser.paymentMethod = method;
                currentUser.paymentAccount = account;
                localStorage.setItem('miningUser', JSON.stringify(currentUser));
                
                // Hide modal and show success
                hideUpdatePaymentModal();
                alert("Payment method updated successfully!");
                
                // Record activity
                db.ref('userLogs/' + Date.now()).set({
                    user: currentUser.username,
                    action: "payment_update",
                    details: `Updated to ${method}: ${account}`,
                    timestamp: Date.now()
                });
            }).catch(error => {
                alert("Error updating payment method: " + error.message);
            }).finally(() => {
                // Reset button
                document.getElementById('updatePaymentText').classList.remove('hidden');
                document.getElementById('updatePaymentSpinner').classList.add('hidden');
                document.getElementById('updatePaymentBtn').disabled = false;
            });
        }

        // Format date
        function formatDate(timestamp) {
            if (!timestamp) return "N/A";
            const date = new Date(timestamp);
            return date.toLocaleDateString() + " " + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        }

        // Show loading spinner
        function showLoading(message = "Loading...") {
            document.getElementById('loadingSpinner').classList.remove('hidden');
            document.querySelector('#loadingSpinner p').textContent = message;
        }

        // Hide loading spinner
        function hideLoading() {
            document.getElementById('loadingSpinner').classList.add('hidden');
        }

        // Check for maintenance mode
        function checkMaintenance() {
            db.ref('settings/maintenanceMode').on('value', snap => {
                if (snap.val() === true) {
                    document.getElementById('maintenanceBanner').classList.remove('hidden');
                } else {
                    document.getElementById('maintenanceBanner').classList.add('hidden');
                }
            });
        }

        // Check for referral code in URL
        function checkReferral() {
            const urlParams = new URLSearchParams(window.location.search);
            const refCode = urlParams.get('ref');
            
            if (refCode) {
                document.getElementById('signupReferral').value = refCode;
            }
        }

        // Initialize the app
        function initApp() {
            // Check maintenance
            checkMaintenance();
            checkReferral();
            
            // Check auth
            checkAuth();
            
            // Smooth scrolling for navigation
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
